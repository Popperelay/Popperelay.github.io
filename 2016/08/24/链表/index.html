<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>数据结构与算法之链表 | Elays&#39;Blog</title>
  <meta name="author" content="Elay">
  
  <meta name="description" content="Elay">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="数据结构与算法之链表"/>
  <meta property="og:site_name" content="Elays&#39;Blog"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Elays&#39;Blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">Elays&#39;Blog</a></h1>
  <h2><a href="/">你是天地生的，美得超越人形</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">主页</a></li>
    
      <li><a href="/archives">所有文章</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-08-24T13:25:00.000Z"><a href="/2016/08/24/链表/">2016-08-24</a></time>
      
      
  
    <h1 class="title">数据结构与算法之链表</h1>
  

    </header>
    <div class="entry">
      
        <p>由于数组的删除、插入是很费时的，所以我们需要链表。<br><a id="more"></a></p>
<hr>
<p>链表的数据结构：节点类+链表类</p>
<ul>
<li><p>节点类：表示链表中的节点，由两个数据成员组成：节点数据Data，指向表内下一节点的引用Link</p>
<pre><code>public class Node {
  public Object Data;
  public Node Next;

  public Node() {
      Data = null;
      Next = null;
  }
  public Node(Object theData) {
      Data = theData;
      Next = null;
  }
}
</code></pre></li>
<li><p>链表类：表示链表中节点之间的链接。数据成员只有一个头节点(如果要用到尾插法，则还需要一个尾节点)，类方法包括：构造函数、链表创建(分为头插法和尾插法)、查找、插入、删除、遍历</p>
<pre><code>class LinkedList
{
  protected Node header;
  protected Node tailer;

  public LinkedList() {
      header = new Node();
      tailer = header;
  }
  //头插法创建单链表(非整表创建)
  public void InsertHead(Object theData) {
      Node newNode = new Node(theData);
      newNode.Next = header.Next;
      header.Next = newNode;
  }
  //尾插法创建单链表(非整表创建)
  public void InsertTail(Object theData) {
      Node newNode = new Node(theData);
      tailer.Next = newNode;
      tailer = newNode;
  }
  //查找
  public Node Find(Object theData) {
      Node current = header.Next;
      while (current != null &amp;&amp; !current.Data.Equals(theData)) {
          current = current.Next;
      }
      return current;
  }
  //插入(在指定内容(theData)的节点后插入新节点)
  public void Insert(Object theData,Object newData) {
      Node current = header.Next;
      while (current != null &amp;&amp; !current.Data.Equals(theData)) {
          current = current.Next;
      }
      //以上的代码和Find方法一致
      if (current != null) {
          Node newNode = new Node(newData);
          newNode.Next = current.Next;
          current.Next = newNode;
      }
  }
  //删除(删除指定内容的节点)
  public void Remove(Object theData) {
      Node current = header.Next;
      Node previous = header.Next;
      while (current != null &amp;&amp; !current.Data.Equals(theData)) {
          previous = current;
          current = current.Next;
      }
      //以上代码和Find方法类似
      if (current != null) {
          previous.Next = current.Next;
      }
  }
  //遍历
  public void ShowList() {
      Node current = header.Next;
      while (current != null) {
          Console.WriteLine(current.Data);
          current = current.Next;
      }
  }       
}
</code></pre><p>注：</p>
</li>
<li>其中的头插法和尾插法都只是向链表中插入了一个节点，如果需要插入多个节点，多次调用即可。这是非整表创建的一种方式，如果需要整表创建，可在LinkedList类中加入如下代码：<pre><code>//头插法整表创建
public void CreateListHead(int n) {
    for (int i = 0; i &lt; n; i++) {
        Object data;
        data=Console.ReadLine();
        InsertHead(data);
    }
}
//尾插法整表创建
public void CreateListTail(int n) {
    for (int i = 0; i &lt; n; i++) {
        object data;
        data = Console.ReadLine();
        InsertTail(data);
    }
}
</code></pre></li>
<li>在代码中节点的数据类型是Object，而在实际问题中最好换成相应的数据类型，否则像<code>list.InsertTail(1);</code>等等传入数值时，将会发生多次装箱拆箱过程，浪费资源</li>
</ul>
<hr>
<p><strong>循环链表</strong><br>循环链表只是把单链表作些许改动：</p>
<ul>
<li>尾节点不再是指向null，而是指向头节点header</li>
<li>判断循环结束的条件不再是current是否为null，而是current不等于头节点header</li>
<li>为了让查找头节点和尾节点的时间复杂度都为O(1)，需要保留一个尾节点的引用(如上述代码中的tailer)，如下图：<br><img src="https://dl85.yunpan.360.cn/intf.php?method=Preview.outputPic&amp;qid=49291271&amp;fname=%2F%E5%9B%BE%E7%89%87%2F%E5%8D%9A%E5%AE%A2%E5%9B%BE%E5%BA%8A%2Flinked.png&amp;fhash=ca435f99fa11e3566c3b7662bf69e8d38eecc7f0&amp;dt=85.31760e2d7af78da5ebdd31a199dbbab2&amp;v=1.0.1&amp;rtick=14720497643939&amp;open_app_id=0&amp;devtype=web&amp;sign=df76c7a61092f8010fe667f4e386c7d9&amp;" alt=""></li>
<li>使用尾节点引用还可以方便地将两个链表链接成一个表：<br><img src="https://dl85.yunpan.360.cn/intf.php?method=Preview.outputPic&amp;qid=49291271&amp;fname=%2F%E5%9B%BE%E7%89%87%2F%E5%8D%9A%E5%AE%A2%E5%9B%BE%E5%BA%8A%2Flinked1.png&amp;fhash=19651392b7e4b656da8d76176a61c825ec27554e&amp;dt=85.7a46b5d7c9921b7f1a3fe18d8a39de6e&amp;v=1.0.1&amp;rtick=14720494924044&amp;open_app_id=0&amp;devtype=web&amp;sign=d3af0202974155145491da7a75e42145&amp;" alt=""><br>将上面两个循环链表合并成一个链表，如下：<br><img src="https://dl85.yunpan.360.cn/intf.php?method=Preview.outputPic&amp;qid=49291271&amp;fname=%2F%E5%9B%BE%E7%89%87%2F%E5%8D%9A%E5%AE%A2%E5%9B%BE%E5%BA%8A%2Flinked3.png&amp;fhash=808850c7ce7751885df34c17c59f5c9ef7c3b7e8&amp;dt=85.fd9db71d87640f8d8c8ce6da22d06ca9&amp;v=1.0.1&amp;rtick=14720498833133&amp;open_app_id=0&amp;devtype=web&amp;sign=14321e25cbe27d254db98581b9674b4e&amp;" alt=""><br>合并的代码如下：<pre><code>headerA = rearA-&gt;next;  //保存A表的头节点,即图中1
rearA-&gt;next = rearB-&gt;next-&gt;next; //将A表的尾节点的Link指向B表的第一个节点(非B表头节点),即图中2
rearB-&gt;next = headerA; //将B表的尾节点的Link指向A表的头节点,即图中3
</code></pre></li>
</ul>
<hr>
<p><strong>双向链表</strong><br>双向链表在单链表上做出的改动：</p>
<ul>
<li><p>节点类增加一个数据成员prior，指向该结点的前驱结点。代码如下：</p>
<pre><code>public class Node {
  public Object Data;
  public Node next;
  public Node prior;  //双向链表新增的数据成员

  public Node() {
      Data = null;
      next = null;
      prior = null;
  }
  public Node(Object theData) {
      Data = theData;
      next = null;
      prior = null;
  }
}
</code></pre></li>
<li><p>插入结点时要不仅要考虑next，还要考虑prior<br><img src="https://dl85.yunpan.360.cn/intf.php?method=Preview.outputPic&amp;qid=49291271&amp;fname=%2F%E5%9B%BE%E7%89%87%2F%E5%8D%9A%E5%AE%A2%E5%9B%BE%E5%BA%8A%2FdoubleLink.png&amp;fhash=75ddfdc8d643826167b8310eb97edfad7f41c6e0&amp;dt=85.bc9fbc7d5dacd883dbac5e7edd857a84&amp;v=1.0.1&amp;rtick=14720521691931&amp;open_app_id=0&amp;devtype=web&amp;sign=305aa4c62c09471c76caa7bed104690d&amp;" alt=""><br>对应代码如下：(顺序很重要)     </p>
<pre><code>s-&gt;prior = p;
s-&gt;next = p-&gt;next;
p-&gt;next-&gt;prior = s;
p-&gt;next = s;
</code></pre></li>
<li><p>删除结点时也要考虑到prior<br><img src="https://dl85.yunpan.360.cn/intf.php?method=Preview.outputPic&amp;qid=49291271&amp;fname=%2F%E5%9B%BE%E7%89%87%2F%E5%8D%9A%E5%AE%A2%E5%9B%BE%E5%BA%8A%2FdoubleLink2.png&amp;fhash=286bda6e02647b16f4feea72152926927f2ad395&amp;dt=85.f86f2e30b782f032d441d9809dc80e0c&amp;v=1.0.1&amp;rtick=14720521695415&amp;open_app_id=0&amp;devtype=web&amp;sign=a3a6b0bf51ef32e8679b865437c8c7a3&amp;" alt=""><br>对应代码如下：</p>
<pre><code>p-&gt;prior-&gt;next = p-&gt;next;
p-&gt;next-&gt;prior = p-&gt;prior;
</code></pre></li>
</ul>
<hr>
<p><strong>链表中头结点存在的意义：</strong></p>
<ul>
<li>如果没有头结点，那么对链表的第一个节点和中间节点的插入删除操作就是不一样的，需要把第一个结点分开来处理，而有了头结点以后，原来的第一个结点和中间结点都变成了中间结点，不用再分开处理。加入头结点后对链表中的所有结点操作就变得一致了。</li>
</ul>

      
    </div>
    <footer>
      
        
  
  <div class="categories">
    <a href="/categories/数据结构/">数据结构</a>
  </div>

        
  
  <div class="tags">
    <a href="/tags/链表/">链表</a>
  </div>

        
  <div class="addthis addthis_toolbox addthis_default_style">
    
      <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
    
    
      <a class="addthis_button_tweet"></a>
    
    
      <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    
    
      <a class="addthis_button_pinterest_pinit" pi:pinit:layout="horizontal"></a>
    
    <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js"></script>

      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h2 class="title">留言</h2>


 
  	   <!-- 多说评论框 start -->
 		<div class="ds-thread" data-thread-key="2016/08/24/链表/" data-title="数据结构与算法之链表" data-url="http://yoursite.com/2016/08/24/链表/"></div>
		<!-- 多说评论框 end -->
		<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
		<script type="text/javascript">
		var duoshuoQuery = {short_name:"popperelay"};   <!-- 替换这里的duoshuo_shortname为前面注册的shortname -->
			(function() {
				var ds = document.createElement('script');
				ds.type = 'text/javascript';ds.async = true;
				ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.unstable.js';
				ds.charset = 'UTF-8';
				(document.getElementsByTagName('head')[0] 
				 || document.getElementsByTagName('body')[0]).appendChild(ds);
			})();
			</script>
		<!-- 多说公共JS代码 end -->
 
  
</section>

</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜索">
    <input type="hidden" name="q" value="site:yoursite.com">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/C-语法/">C#语法</a><small>2</small></li>
  
    <li><a href="/categories/博客配置/">博客配置</a><small>2</small></li>
  
    <li><a href="/categories/数据结构/">数据结构</a><small>15</small></li>
  
    <li><a href="/categories/游戏开发/">游戏开发</a><small>1</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">标签</h3>
  <ul class="entry">
  
    <li><a href="/tags/C-容器/">C#容器</a><small>1</small></li>
  
    <li><a href="/tags/MarkDown/">MarkDown</a><small>1</small></li>
  
    <li><a href="/tags/timeTest/">timeTest</a><small>1</small></li>
  
    <li><a href="/tags/二叉树/">二叉树</a><small>1</small></li>
  
    <li><a href="/tags/关键路径/">关键路径</a><small>1</small></li>
  
    <li><a href="/tags/图/">图</a><small>1</small></li>
  
    <li><a href="/tags/多说/">多说</a><small>1</small></li>
  
    <li><a href="/tags/头结点/">头结点</a><small>1</small></li>
  
    <li><a href="/tags/尾递归/">尾递归</a><small>1</small></li>
  
    <li><a href="/tags/帧同步/">帧同步</a><small>1</small></li>
  
    <li><a href="/tags/拓扑排序/">拓扑排序</a><small>1</small></li>
  
    <li><a href="/tags/改进排序/">改进排序</a><small>1</small></li>
  
    <li><a href="/tags/最小生成树/">最小生成树</a><small>1</small></li>
  
    <li><a href="/tags/最短路径/">最短路径</a><small>1</small></li>
  
    <li><a href="/tags/查找/">查找</a><small>1</small></li>
  
    <li><a href="/tags/栈/">栈</a><small>1</small></li>
  
    <li><a href="/tags/树/">树</a><small>1</small></li>
  
    <li><a href="/tags/简单排序/">简单排序</a><small>1</small></li>
  
    <li><a href="/tags/链表/">链表</a><small>1</small></li>
  
    <li><a href="/tags/队列/">队列</a><small>1</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2016 Elay
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>